public static class SortFunction extends RichFlatMapFunction<Tuple2<String, String>, Tuple2<String, String>> {
        private static final DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd");
        private final List<Tuple2<String, String>> buffer = new ArrayList<>();

        @Override
        public void open(Configuration parameters) {
            // No state needed
        }

        @Override
        public void flatMap(Tuple2<String, String> value, Collector<Tuple2<String, String>> out) {
            buffer.add(value);
        }

        @Override
        public void close() {
            buffer.sort(Comparator.comparing(e -> LocalDate.parse(e.f0, formatter)));
            for (Tuple2<String, String> element : buffer) {
                System.out.println(element); // Printing sorted output
            }
        }
    }
